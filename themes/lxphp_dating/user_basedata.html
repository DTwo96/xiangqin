<!DOCTYPE html>
<html lang="zh">

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
		<meta content="yes" name="apple-mobile-web-app-capable">
		<meta content="black" name="apple-mobile-web-app-status-bar-style">
		<meta name="format-detection" content="telephone=no">
		<meta http-equiv="Cache-Control" content="no-cache, must-revalidate">
		<title>{$media.title}</title>
		<link rel="stylesheet" type="text/css" href="css/css.css?t=<?php echo time();?>">
		<link rel="stylesheet" type="text/css" href="/Public/layui-v2.5.6/css/layui.css">
		<script type="text/javascript" src="js/jquery-1.8.0.min.js"></script>

	
    <script src="js/time/mobiscroll_002.js" type="text/javascript"></script>
	<script src="js/time/mobiscroll_004.js" type="text/javascript"></script>
	<link href="css/time/mobiscroll_002.css" rel="stylesheet" type="text/css">
	<link href="css/time/mobiscroll.css" rel="stylesheet" type="text/css">
	<script src="js/time/mobiscroll.js" type="text/javascript"></script>
	<script src="js/time/mobiscroll_003.js" type="text/javascript"></script>
	<script src="js/time/mobiscroll_005.js" type="text/javascript"></script>
	<link href="css/time/mobiscroll_003.css" rel="stylesheet" type="text/css">

<style type="text/css">
       .fx_header {
              position: fixed;
              top: 0px;
                }
	   .long-item {
		   position: relative;
	   }
	   .long-item textarea {
		   clear: both;
		   display: block;
		   border-color: #e2e2e2;
		   border-radius: 4px;
		   width: 94%;
		   margin-top: 30px;
		   padding: 10px;
	   }
		.long-item .num-block {
			position: absolute;
			right: 4px;
			bottom: 18px;
			font-size: 14px;
		}
	   .long-item img {
		   width: 14px;
	   }
	.cb-item input:not([type="checkbox"]){
		width: 62% !important;
	}
	.cb-item-checkbox {
		float: right !important;
		margin-right: 10px !important;
	}
	.unit {
		color: #c2c2c2;
		margin-left: 4px;
	}
	.panel-item {
		overflow: hidden;
	}
	.panel-item input{
		vertical-align: middle;
		margin-right: 20px;
	}
	.panel-content {
		width: 100% !important;
		display: none;
	}
   .panel-content > div {
	   float: none !important;
	   overflow: hidden;
	   padding: 6px 0px;
   }
	.panel-content div {
		border-bottom: 1px dotted #ccc;
	}
   .panel-content div:last-child {
	   border: none;
   }
	.clearfix {
		clear: both;
	}
	.phone-item a:active{
		color: #f03b57 !important;
	}
	.jibenziliao .phone-item input,.jibenziliao .email-item input {
		width: 140px !important;
	}
	   .layui-form-checkbox[lay-skin=primary] span {
		   padding: 0px !important;
		   color: #666 !important;
	   }
	   .x-item input {
		   color: green !important;
	   }
		.panel-item .layui-form-radio {
			margin: 0px !important;
		}
	   .panel-item .layui-form-radio div:nth-of-type(1){
			margin-right: 4px !important;
	   }
		.layui-form-checkbox {
			margin-top: 2px !important;
		}
	@media screen and (max-width: 375px){
		.layui-form-checkbox[lay-skin=primary] {
			padding-left: 20px;
		}
	}
	@media screen and (max-width: 320px){
		.cb-item input {
			font-size: 12px !important;
		}
		.jibenziliao .phone-item input{
			width: 100px !important;
		}
		#appDate {
			width: 30% !important;
		}
	}
  </style>



	</head>

	<body>
	
		<div class="hd_main">
		<div style="height:40px;display:none ;" class="appdiv fx_header_new"></div>
  <!--#include file="app_share.html"-->
			<div class="siliao_header">
				基本资料
				<a href="javascript:history.go(-1);" class="fl" id="ddd"><img src="images/zuojian.png" style="width:11px;">返回</a>
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</div>
			

				<div class="jibenziliao">
					<ul>
						<li>
							<div>账号</div>
							<input type="text" name="user_number" readonly value="{$base.user_number}" placeholder="请填写用户名" class="jibenziliao_input" style="width:65%">
							<!--{if condition="$base['open']"}--><em style="color: red;" >({$base.open})</em><!--{/if}-->
						</li>
						<li>
							<div>真实姓名</div>
							<input type="text" name="real_name" value="{$base.real_name}" placeholder="请填写真实姓名" class="jibenziliao_input" style="width:65%">
						</li>
						<li class="layui-form"><div style="margin-right: 0px !important;">性别</div><span class="dede">
							<input type="checkbox" name="sex" value="1" title="男生" lay-skin="primary" <!--{if condition="$base['sex'] eq 1"}-->checked<!--{/if}--> disabled>
							<input type="checkbox" name="sex" value="2" title="女生" lay-skin="primary" <!--{if condition="$base['sex'] eq 2"}-->checked<!--{/if}--> disabled>（如需修改，请联系客服）
						</li>
						<input name="sex" type="hidden" id="sex" value="{$base.sex}" />
						<!--<li><div>年龄</div><input type="text" name="age" value="{$base.age}" placeholder="请填写您的年龄" class="jibenziliao_input"></li>-->
						<li class="cb-item phone-item x-item"><div>手机号</div>
							<input class="jibenziliao_input" placeholder="请填写手机号" readonly type="text" name="user_login" value="{$base['user_login']}">
							<div class="cb-item-checkbox">
								<a href="{:U('editPhone')}" style="font-size: 14px; color: #c2c2c2;">点击去修改手机号</a>
							</div>
						</li>
						<li class="cb-item x-item layui-form"><div>微信号</div>
							<input class="jibenziliao_input" placeholder="请填写微信号，没有可以选择无" style="width: 60px;" type="text" name="weixin" value="{$base['weixin']}">
							<div class="cb-item-checkbox">
								无 <input type="checkbox" title="" lay-skin="primary" class="c-btn" data-type="" value="">
							</div>
						</li>
						<li class="cb-item x-item layui-form"><div>QQ号</div>
							<input class="jibenziliao_input" placeholder="请填写QQ号，没有可以选择无" style="width: 60px;" type="number" name="qq" value="{$base['qq']}">
							<div class="cb-item-checkbox">
								无 <input type="checkbox" title="" lay-skin="primary" class="c-btn" data-type="" value="">
							</div>
						</li>
						<!--<li class="cb-item email-item x-item"><div>邮箱号</div>
							<input class="jibenziliao_input" placeholder="请填写邮箱号" style="width: 60px;" type="text" name="email" value="{$base['email']}">
							<div class="cb-item-checkbox">
								<a href="{:U('editPhone')}" style="font-size: 14px; color: #c2c2c2;">点击去修改邮箱号</a>
							</div>
						</li>-->
						<li class="cb-item x-item layui-form"><div>微博号</div>
							<input class="jibenziliao_input" placeholder="请填写微博号，没有可以选择无" style="width: 60px;" type="text" name="weibo" value="{$base['weibo']}">
							<div class="cb-item-checkbox">
								无 <input type="checkbox" title="" lay-skin="primary" class="c-btn" data-type="" value="">
							</div>
						</li>
						<li><div>星座</div>
							<select name="astro" class="astro" >
								<option value="0" >请选择</option>
								<!--{foreach name="astro" key="k" item="vo" }-->
			 		        		<option value="{$k}" <!--{if condition="$base['astro']==$k"}-->selected<!--{/if}--> >{$vo}</option> 				 		        		
			 		       		<!--{/foreach}--> 
			 		   		</select>
						</li>
						<li><div>年龄</div>
							<input class="jibenziliao_input" style="width: 60px;" type="number" name="age" value="{$base['age']}"><span class="unit">岁</span>
						</li>
						<li>
							<div>生日</div>
							<input style="width: 26%" value="{$base.birthday}" class="jibenziliao_input" readonly="readonly" name="appDate" id="appDate" type="text" placeholder="请选择出生年月"> <span class="unit">阳历</span>
						</li>
						
						
						
						<li><div>地区</div>
							<select name="provinceid" id="provinceid" >
								<option value="0" >请选择</option>
								<!--{foreach name="province" item="vo" }-->
		 		        			<option value="{$vo.areaid}" <!--{if condition="$base['provinceid']==$vo['areaid']"}-->selected<!--{/if}--> >{$vo.areaname}</option>
		 		       			<!--{/foreach}--> 
	     		    		</select>
	     		    		
							<select name="cityid" id="cityid" >
					     		<option value="0" >请选择</option>
					     		<!--{foreach name="city" item="vo" }-->
					     		    <option value="{$vo.areaid}" <!--{if condition="$base['cityid']==$vo['areaid']"}-->selected<!--{/if}--> >{$vo.areaname}</option>
					     		<!--{/foreach}--> 
				         	</select>
						</li>
						<li><div>身高</div>
							<input class="jibenziliao_input" style="width: 60px;" type="number" name="height" value="{$base['height']}"><span class="unit">厘米</span>
						</li>
						<li>
							<div>学历</div>
							<select name="education">
								<option value="0" >请选择</option>
								<!--{foreach name="education_setting" key="k" item="vo" }-->
								<option value="{$k}" <!--{if condition="$base['education']==$k"}-->selected<!--{/if}--> >{$vo}</option>
								<!--{/foreach}-->
							</select>
						</li>
						<li class="cb-item layui-form"><div>大学</div>
							<input class="jibenziliao_input" placeholder="请填写大学，没有可以选择无" style="width: 60px;" type="text" name="university" value="{$base['university']}">
							<div class="cb-item-checkbox">
								无 <input type="checkbox" title="" lay-skin="primary" class="c-btn" data-type="university" value="university">
							</div>
						</li>
						<li class="cb-item layui-form">
							<div>工作</div>
							<input type="text" name="work" value="{$base.work}" placeholder="请填写工作，没有可以选择无" class="jibenziliao_input" style="width:65%">
							<div class="cb-item-checkbox">
								无 <input type="checkbox" title="" lay-skin="primary" class="c-btn" data-type="work" value="work">
							</div>
						</li>
						<li><div>月收入</div>
							<input class="jibenziliao_input" style="width: 60px;" type="number" name="month_income" value="{$base['month_income']}"><span class="unit">元</span>
						</li>
						<!--{foreach name="profile" key="key" item="val"}-->
							<!--{if condition="!in_array($key,['code2','code3'])"}-->
								<li>
									<div>{$val.name}</div>
									<select name="{$key}" class="{$key}" >
										<option value="0" >请选择</option>
										<!--{foreach name="val.info" key="k" item="vo" }-->
										<option value="{$k}" <!--{if condition="$base[$key]==$k"}-->selected<!--{/if}--> >{$vo}</option>
										<!--{/foreach}-->
									</select>
								</li>
							<!--{/if}-->
						<!--{/foreach}-->
						<li class="panel-item layui-form">
							<div>是否有房</div>
							<input type="radio" class="panel-btn" name="house_info[is_buy_house]" title="有" value="1" <?php if ($base['house_info']['is_buy_house']){?>checked<?php }?>>
							<input type="radio" class="panel-btn" name="house_info[is_buy_house]" title="无" value="0" <?php if (!$base['house_info']['is_buy_house']){?>checked<?php }?>>
							<div class="clearfix"></div>
							<div class="panel-content">
								<div><input type="radio" name="house_info[condition]" title="贷款" value="0" <?php if (!$base['house_info']['condition']){?>checked<?php }?>></div>
								<div><input type="radio" name="house_info[condition]" title="全款" value="1" <?php if ($base['house_info']['condition']){?>checked<?php }?>></div>
							</div>
						</li>
						<li class="panel-item layui-form"><div>是否有车</div>
							<input type="radio" class="panel-btn" name="car_info[is_buy_car]" title="有" value="1" <?php if ($base['car_info']['is_buy_car']){?>checked<?php }?>>
							<input type="radio" class="panel-btn" name="car_info[is_buy_car]" title="无" value="0" <?php if (!$base['car_info']['is_buy_car']){?>checked<?php }?>>
							<div class="clearfix"></div>
							<div class="panel-content">
								<div><input type="radio" name="car_info[condition]" title="贷款" value="0" <?php if (!$base['car_info']['condition']){?>checked<?php }?>></div>
								<div><input type="radio" name="car_info[condition]" title="全款" value="1" <?php if ($base['car_info']['condition']){?>checked<?php }?>></div>
							</div>
						</li>
						<li class="xqah long-item"><div>兴趣爱好</div>
							<textarea name="hobby" cols="45" rows="5" onkeyup="words_deal(2);" placeholder="添加兴趣爱好，不超过100个字…">{$base['hobby']}</textarea>
							<div class="num-block">
								<span class="textCount hobby-t-cnt">100</span>
							</div>
						</li>
						<li class="lxdb long-item">
							<div>内心独白</div>
							<textarea name="monolog" cols="45" rows="5" onkeyup="words_deal(1);" placeholder="添加内心独白，不超过300个字…">{$base['monolog']}</textarea>
							<div class="num-block">
								<span class="textCount monolog-t-cnt">300</span><img src="images/suiji.png" class="suiji" id="get-suiji">
							</div>
						</li>




					</ul>
				</div>
				<input type="button" value="保存" class="jichubaoc"  >

				<!--#include file="footer.html"-->

		</div>
		<script type="text/javascript" src="/Public/layui-v2.5.6/layui.js"></script>
		<script type="text/javascript">
			layui.use('form',function () {
				var form = layui.form;
				form.on('radio()',function (data) {
                    var v = data.value;
                    if (v == 1) {
                        $(this).siblings('.panel-content').show();
                    } else {
                        $(this).siblings('.panel-content').hide();
                    }
                });

                form.on('checkbox()',function (data) {
                    if (data.elem.checked) {
                        $(this).parent().siblings().val('');
                    }
                });

                $('.cb-item input:not([type="checkbox"])').on('click',function () {
                    var elem = $(this).parent().find('.c-btn');
                    if (elem.prop('checked')) {
                        elem.siblings('.layui-form-checkbox').find('.layui-icon-ok').click();
					}
                });

                initPanelBtnAction();
                function initPanelBtnAction() {
                    $('.panel-btn:checked').each(function (i,e) {
                        var v = $(e).val();
                        if (v == 1) {
                            $(e).siblings('.panel-content').show();
                        }
                    });
                }
            });
			//性别选择效果
			/*
			$(".jibenziliao ul li .dede i").click(function() {
				var index = $(this).index();
				$(".jibenziliao ul li .dede i").removeClass("sheng").eq(index).addClass("sheng");
				$('#sex').val($(this).attr('data'));
			})
			*/
			
			
			//省份选择事件
			$(function(){
				$('#provinceid').change(function(){
					var url = "{:U('Home/Ajax/ajax_get_city')}";
		    		var provinceid =  $(this).val();
		    		if(!provinceid) return false;
					$.post(url,{provinceid:provinceid},function(json){
						html = '<option value="0">请选择</option>';
						if(json){					
							$.each(json, function(idx, item) {
								html += '<option value="'+item.areaid+'">'+ item.areaname + '</option>';
							});	               
							$("#cityid").html(html);
						}			
					},'json');			
				})

				$('#get-suiji').on('click',function () {
				    var self = $(this);
                    $.post('{:U("getSjTitle")}',{type:2},function(data){
                        if(data.status == 1){
							self.parent().siblings('textarea').val(data.info);
                            words_deal(1);
                        }
                    },'json');
                });

				$('.c-btn').on('click',function () {
					var type = $(this).data('type');
					if ($(this).prop('checked')) {
					    $(this).parent().siblings().val('');
					}
                });
			})
            function words_deal(type) {
                if (type == 1) { //内心独白
                    var el        = $("[name='monolog']"),
                        curLength = el.val().length;

                    if (curLength > 300) {
                        var num = el.val().substr(0, 300);
                        el.val(num);
                        alertmsg("超过字数限制，多出的字将被截断！");
                    } else {
                        $(".monolog-t-cnt").text(300 - curLength);
                    }
                } else { //兴趣爱好
                    var el        = $("[name='hobby']"),
                        curLength = el.val().length;

                    if (curLength > 100) {
                        var num = el.val().substr(0, 100);
                        el.val(num);
                        alertmsg("超过字数限制，多出的字将被截断！");
                    } else {
                        $(".hobby-t-cnt").text(100 - curLength);
                    }
                }
            }
		</script>
		
		
		<script>			
			//提交
			$(function(){
				$('.jichubaoc').click(function(){
					//昵称必填
					var user_nicename = $("input[name = 'user_nicename']").val();//昵称
					if(user_nicename == ''){
						alertmsg("昵称必填");
						return false;
					}
					
					setDisabled($(this),'保存中');
					
					var o = $('.jibenziliao ul li');
				
//					var age = $("input[name = 'age']").val();//年龄
					var sex = $('input[name="sex"]').val();//性别
					var astro = $(".astro").val();
					var birthday = $("#appDate").val();
					var provinceid = $("#provinceid").val();
					var cityid = $("#cityid").val();
					var uid = $("input[name='id']").val();
					var code1 =  $(".code1").val();
					var code2 =  $(".code2").val();;
					var code3 =  $(".code3").val();;
					var code4 =  $(".code4").val();;

					var education = $("[name='education']").val();
					var height    = $("[name='height']").val();
					var month_income = $("[name='month_income']").val();
					var real_name = $('[name="real_name"]').val();
					var work      = $('[name="work"]').val();
					var university = $('[name="university"]').val();
                    var hobby     = $('[name="hobby"]').val();
                    var monolog     = $('[name="monolog"]').val();
                    var qq        = $('[name="qq"]').val();
                    var weibo     = $('[name="weibo"]').val();
                    var email     = $('[name="email"]').val();
                    var weixin    = $('[name="weixin"]').val();
                    var age       = $('[name="age"]').val();
                    var car_info  = $('[name="car_info"]:checked').val();
                    var is_buy_house =  $('[name="house_info[is_buy_house]"]:checked').val();
                    var house_condition =  $('[name="house_info[condition]"]:checked').val();
                    var is_buy_car =  $('[name="car_info[is_buy_car]"]:checked').val();
                    var car_condition =  $('[name="car_info[condition]"]:checked').val();

                    if (real_name != '') {
                        var rule_1 = /^[\u4E00-\u9FA5]+$/,
							rule_2 = /^[A-Za-z]+$/;

                        if (!rule_1.test(real_name) && !rule_2.test(real_name)) {
                            alertmsg('真实姓名只能为纯汉字或纯英文字母');
                            unDisabled($('.jichubaoc'),'保存');
                            return false;
                        } else {
                            let _l   = real_name.length,
								rule = /^[\u4E00-\u9FA5]+$/;

                            if (rule.test(real_name)) {
								if (_l > 4) {
                                    alertmsg('中文姓名的最大长度为4位');
                                    unDisabled($('.jichubaoc'),'保存');
                                    return false;
								}
							} else {
                                if (_l > 16) {
                                    alertmsg('英文姓名的最大长度为16位');
                                    unDisabled($('.jichubaoc'),'保存');
                                    return false;
                                }
							}
						}
                    }
                    if (weixin != '') {
                        var rule = /^[a-zA-Z]([-_a-zA-Z0-9]{5,19})+$/;
                        if (!rule.test(weixin)) {
                            alertmsg('请填写有效的微信号');
                            unDisabled($('.jichubaoc'),'保存');
                            return false;
                        }
                    }
                    if (qq != '') {
                        var rule = /^[1-9][0-9]{4,10}$/;
						if (!rule.test(qq)) {
                            alertmsg('请填写有效的QQ号码');
                            unDisabled($('.jichubaoc'),'保存');
                            return false;
						}
					}
                    /*if (email != '') {
                        var rule = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;
                        if (!rule.test(email)) {
                            alertmsg('请填写有效的Email');
                            unDisabled($('.jichubaoc'),'保存');
                            return false;
                        }
                    }*/

                    if (age != '') {
                        var d = new Date();
                        var y = d.getFullYear();

                        age = y - age;
					}

					$.ajax({
						type:"post",
						url:"{:U()}",
						data:{is_buy_house:is_buy_house,house_condition:house_condition,is_buy_car:is_buy_car,car_condition:car_condition,weixin:weixin,age:age,qq:qq,weibo:weibo,email:email,hobby:hobby,monolog:monolog,university:university,work:work,real_name:real_name,education:education,height:height,month_income:month_income,uid:uid,user_nicename:user_nicename,sex:sex,astro:astro,birthday:birthday,provinceid:provinceid,cityid:cityid,code1:code1,code2:code2,code3:code3,code4:code4},
						dataType: "json",
						success:function(msg){
							if( msg.type == 3 ){
								alertmsg('保存失败');
								unDisabled($('.jichubaoc'),'保存');
							}else{
								if( msg.type == 2 ){  //没开启审核   不用提示再审
									var obj = o.eq(0).find('em');
									if(obj.length != 0){
										obj.text('(审核中)');
									}else{
										o.eq(0).append('<em style="color: red;" >(审核中)</em>');
									}								
								}
								alertmsg('保存成功');
								unDisabled($('.jichubaoc'),'已保存');								
							}					
						}
					});						
				});
			})
	
			
		</script>
			<script type="text/javascript">
        $(function () {
			var currYear = (new Date()).getFullYear();	
			
			var opt={};
			opt.date = {preset : 'date'};
			opt.datetime = {preset : 'datetime'};
			opt.time = {preset : 'time'};
			opt.default = {
				theme: 'android-ics light', //皮肤样式
		        display: 'modal', //显示方式 
		        mode: 'scroller', //日期选择模式
				dateFormat: 'yyyy-mm-dd',
				lang: 'zh',
				showNow: true,
				nowText: "今天",
		        startYear: 1950, //开始年份
		        endYear: currYear + 0 //结束年份
			};

		  	$("#appDate").mobiscroll($.extend(opt['date'], opt['default']));
		  	var optDateTime = $.extend(opt['datetime'], opt['default']);
		  	var optTime = $.extend(opt['time'], opt['default']);
		    $("#appDateTime").mobiscroll(optDateTime).datetime(optDateTime);
		    $("#appTime").mobiscroll(optTime).time(optTime);
        });
    </script>
	</body>
</html>